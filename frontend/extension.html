<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PitchLense ‚Äî Extension</title>
    <link rel="icon" type="image/svg+xml" href="/static/logo.svg" />
    <script>
      tailwind.config = { theme: { extend: { colors: { background:'#1E1E21', surface:'#2E3137', text:'#ffffff', secondary:'#cfd4dd', accent:'#f1d85b' }}}}
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body class="bg-background text-text font-sans antialiased overflow-x-hidden bg-solid">
    <div class="h-screen flex flex-col p-3 gap-3">
      <header class="h-16 bg-[#2E3137] border border-white/10 rounded-[22px] flex items-center justify-between px-6 mobile-header">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-full bg-accent grid place-items-center"><img src="/static/logo.svg" class="w-5 h-5"/></div>
          <div class="text-base font-semibold">PitchLense Extension</div>
        </div>
        <div class="flex items-center gap-3">
          <!-- Mobile menu button -->
          <button id="mobileMenuBtn" class="md:hidden w-9 h-9 grid place-items-center rounded-full bg-[#FFF27A] border border-white/10 text-[#1E1E21]">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="3" y1="6" x2="21" y2="6"/>
              <line x1="3" y1="12" x2="21" y2="12"/>
              <line x1="3" y1="18" x2="21" y2="18"/>
            </svg>
          </button>
          <div id="searchWrap" class="flex items-center gap-2">
            <button id="searchBtn" class="w-9 h-9 grid place-items-center rounded-full bg-[#FFF27A] border border-white/10 text-[#1E1E21]">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="7"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </button>
            <input id="searchInput" type="text" placeholder="Search" class="h-9 w-0 opacity-0 px-0 bg-[#1E1E21] border border-white/10 rounded-full text-sm text-white/80 outline-none transition-all duration-200" />
            <button id="refreshBtn" title="Refresh" class="w-9 h-9 grid place-items-center rounded-full bg-[#FFF27A] border border-white/10 text-[#1E1E21]">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"/>
                <polyline points="1 20 1 14 7 14"/>
                <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"/>
                <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"/>
              </svg>
            </button>
          </div>
          <div id="userProfileIcon" class="w-9 h-9 rounded-full border border-white/10 bg-[#FFF27A] grid place-items-center text-[#1E1E21] relative group">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
              <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-3.31 0-6 2.69-6 6h12c0-3.31-2.69-6-6-6Z"/>
            </svg>
            <!-- User email tooltip -->
            <div id="userEmailTooltip" class="absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
              <span id="userEmailText">Loading...</span>
              <!-- Tooltip arrow -->
              <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-b-4 border-transparent border-b-[#1E1E21]"></div>
            </div>
          </div>
        </div>
      </header>

      <div class="grid flex-1 min-h-0 mobile-navbar" style="grid-template-columns: 84px 1fr; gap:12px;">
        <!-- Mobile responsive styles -->
        <style>
          @media (max-width: 768px) {
            .mobile-navbar {
              grid-template-columns: 1fr !important;
              gap: 8px !important;
            }
            .mobile-main {
              padding: 12px !important;
            }
            .mobile-header {
              padding: 12px 16px !important;
            }
            #pitchlense-navbar {
              display: none !important;
            }
          }
          @media (max-width: 480px) {
            .mobile-card {
              padding: 16px !important;
            }
            .mobile-header {
              padding: 8px 12px !important;
            }
            .mobile-main {
              padding: 8px !important;
            }
          }
        </style>
        <aside id="pitchlense-navbar" class="bg-[#2C2F34] border border-white/10 rounded-[18px] flex flex-col items-center py-4 gap-3">
          <nav class="flex flex-col gap-2 text-white/80 w-full items-center">
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10" href="/create-report.html" title="Create">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10" href="/view-report.html" title="Reports">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <line x1="9" y1="17" x2="9" y2="11"/>
                <line x1="13" y1="17" x2="13" y2="7"/>
                <line x1="17" y1="17" x2="17" y2="13"/>
              </svg>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="/market.html" title="Market">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3v18h18"/>
                <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Market Data
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="/investment.html" title="Investments">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Investments
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="/search.html" title="Search">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Search Symbols
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="/news.html" title="News">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3h16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/>
                <line x1="7" y1="8" x2="17" y2="8"/>
                <line x1="7" y1="12" x2="17" y2="12"/>
                <line x1="7" y1="16" x2="13" y2="16"/>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Market News
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg bg-white/10 hover:bg-white/10 relative group" href="/extension.html" title="Extension">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Extension
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="/email.html" title="Email">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                <polyline points="22,6 12,13 2,6"/>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                Email Client
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
            <a class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 relative group" href="https://youtu.be/XUuLeXaEIdI" target="_blank" title="How to use PitchLense">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
              </svg>
              <!-- Tooltip -->
              <div class="absolute left-full ml-2 px-3 py-2 bg-[#1E1E21] text-white text-sm rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50">
                How to use PitchLense
                <!-- Tooltip arrow -->
                <div class="absolute right-full top-1/2 transform -translate-y-1/2 w-0 h-0 border-t-4 border-b-4 border-r-4 border-transparent border-r-[#1E1E21]"></div>
              </div>
            </a>
          </nav>
          <div class="flex-1"></div>
          <button id="signoutBtn" class="w-10 h-10 grid place-items-center rounded-lg hover:bg-white/10 text-white/80" title="Sign out">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
          </button>
        </aside>

        <main class="flex-1 overflow-y-auto p-4 mobile-main">
          <div class="text-center mb-6">
            <h2 class="text-2xl font-semibold mb-2">Extension Setup</h2>
            <p class="text-white/60">Get started with PitchLense browser extension in 5 minutes</p>
          </div>

          <!-- Download Extension Button -->
          <div class="text-center mb-6">
            <button 
              id="downloadExtensionBtn" 
              class="px-6 py-3 bg-accent text-[#1E1E21] font-semibold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 mx-auto"
            >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7,10 12,15 17,10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Download Extension
            </button>
          </div>

          <!-- Extension Setup Guide -->
          <div class="max-w-4xl mx-auto">
            <div class="bg-[#2E3137] border border-white/10 rounded-xl p-6 mb-4">
              <div class="prose prose-invert max-w-none">
                <h3 class="text-xl font-semibold text-white mb-4 flex items-center gap-2">
                  üöÄ Quick Start Guide
                </h3>
                
                <!-- Step 1: Download -->
                <div class="mb-8">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    <span class="w-6 h-6 bg-accent text-[#1E1E21] rounded-full flex items-center justify-center text-sm font-bold">1</span>
                    Download Extension Zip
                  </h4>
                  <div class="bg-[#1E1E21] border border-white/10 rounded-lg p-4 mb-3">
                    <p class="text-white/80 mb-4">First, download the extension files as a zip archive:</p>
                    <button 
                      id="downloadZipBtn" 
                      class="w-full px-4 py-3 bg-yellow-400 text-[#1E1E21] font-semibold rounded-lg hover:bg-yellow-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg border-2 border-yellow-500"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                        <polyline points="14,2 14,8 20,8"/>
                        <line x1="16" y1="13" x2="8" y2="13"/>
                        <line x1="16" y1="17" x2="8" y2="17"/>
                        <polyline points="10,9 9,9 8,9"/>
                      </svg>
                      Download Extension.zip
                    </button>
                  </div>
                </div>

                <!-- Step 2: Generate Icons -->
                <div class="mb-8">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    <span class="w-6 h-6 bg-accent text-[#1E1E21] rounded-full flex items-center justify-center text-sm font-bold">2</span>
                    Generate Icons (Required)
                  </h4>
                  <div class="bg-[#1E1E21] border border-white/10 rounded-lg p-4">
                    <ol class="text-white/80 space-y-2 list-decimal list-inside">
                      <li><strong>Open the icon generator</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Navigate to <code class="bg-white/10 px-1 rounded">extension/generate_icons.html</code> in your browser</li>
                          <li>‚Ä¢ Download all 4 icon files (16x16, 32x32, 48x48, 128x128)</li>
                          <li>‚Ä¢ Replace the placeholder PNG files in <code class="bg-white/10 px-1 rounded">extension/icons/</code> folder</li>
                        </ul>
                      </li>
                    </ol>
                  </div>
                </div>

                <!-- Step 3: Load Extension -->
                <div class="mb-8">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    <span class="w-6 h-6 bg-accent text-[#1E1E21] rounded-full flex items-center justify-center text-sm font-bold">3</span>
                    Load Extension in Chrome
                  </h4>
                  <div class="bg-[#1E1E21] border border-white/10 rounded-lg p-4">
                    <ol class="text-white/80 space-y-3 list-decimal list-inside">
                      <li><strong>Open Chrome Extensions</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Go to <code class="bg-white/10 px-1 rounded">chrome://extensions/</code></li>
                          <li>‚Ä¢ OR: Chrome Menu ‚Üí More Tools ‚Üí Extensions</li>
                        </ul>
                      </li>
                      <li><strong>Enable Developer Mode</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Toggle "Developer mode" in top-right corner</li>
                        </ul>
                      </li>
                      <li><strong>Load Extension</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Click "Load unpacked"</li>
                          <li>‚Ä¢ Select the <code class="bg-white/10 px-1 rounded">extension</code> folder (after extracting the zip)</li>
                          <li>‚Ä¢ Click "Select Folder"</li>
                        </ul>
                      </li>
                      <li><strong>Verify Installation</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ ‚úÖ PitchLense appears in extensions list</li>
                          <li>‚Ä¢ ‚úÖ Extension icon shows in Chrome toolbar</li>
                        </ul>
                      </li>
                    </ol>
                  </div>
                </div>

                <!-- Step 4: Test Functionality -->
                <div class="mb-8">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    <span class="w-6 h-6 bg-accent text-[#1E1E21] rounded-full flex items-center justify-center text-sm font-bold">4</span>
                    Test Basic Functionality
                  </h4>
                  <div class="bg-[#1E1E21] border border-white/10 rounded-lg p-4">
                    <ol class="text-white/80 space-y-3 list-decimal list-inside">
                      <li><strong>Click Extension Icon</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Should open popup with settings and buttons</li>
                          <li>‚Ä¢ Check that "Analyze Current Page" button is visible</li>
                        </ul>
                      </li>
                      <li><strong>Visit Any Website</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Go to any webpage (e.g., google.com)</li>
                          <li>‚Ä¢ Look for green üéØ button in top-right corner</li>
                        </ul>
                      </li>
                      <li><strong>Test Floating Button</strong>:
                        <ul class="ml-4 mt-1 space-y-1 text-sm text-white/60">
                          <li>‚Ä¢ Click the üéØ button</li>
                          <li>‚Ä¢ Should show loading state (‚è≥)</li>
                          <li>‚Ä¢ Will show error if backend not running (this is expected)</li>
                        </ul>
                      </li>
                    </ol>
                  </div>
                </div>


                <!-- Expected Results -->
                <div class="mb-6">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    üéØ Expected Results
                  </h4>
                  <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-green-900/20 border border-green-500/30 rounded-lg p-4">
                      <h5 class="font-semibold text-green-400 mb-2">‚úÖ Working Extension Should Show:</h5>
                      <ul class="text-sm text-green-300 space-y-1">
                        <li>‚Ä¢ Extension icon in Chrome toolbar</li>
                        <li>‚Ä¢ Popup opens when clicked</li>
                        <li>‚Ä¢ Floating button on web pages</li>
                        <li>‚Ä¢ Settings can be changed and saved</li>
                        <li>‚Ä¢ Status shows connection state</li>
                      </ul>
                    </div>
                    <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4">
                      <h5 class="font-semibold text-yellow-400 mb-2">‚ö†Ô∏è Expected Errors (Without Backend):</h5>
                      <ul class="text-sm text-yellow-300 space-y-1">
                        <li>‚Ä¢ "Analysis failed: Failed to analyze page"</li>
                        <li>‚Ä¢ Status shows "Disconnected"</li>
                        <li>‚Ä¢ API shows "Offline"</li>
                      </ul>
                      <p class="text-xs text-yellow-200 mt-2">This is normal when the backend isn't running!</p>
                    </div>
                  </div>
                </div>

                <!-- Troubleshooting -->
                <div class="mb-6">
                  <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                    üîß Troubleshooting
                  </h4>
                  <div class="bg-[#1E1E21] border border-white/10 rounded-lg p-4">
                    <div class="space-y-4">
                      <div>
                        <h6 class="font-semibold text-white mb-2">Extension Won't Load:</h6>
                        <ul class="text-sm text-white/60 space-y-1 ml-4">
                          <li>‚Ä¢ Check all files are in <code class="bg-white/10 px-1 rounded">extension/</code> folder</li>
                          <li>‚Ä¢ Verify <code class="bg-white/10 px-1 rounded">manifest.json</code> exists and is valid</li>
                          <li>‚Ä¢ Make sure icons are PNG files (not SVG)</li>
                        </ul>
                      </div>
                      <div>
                        <h6 class="font-semibold text-white mb-2">Floating Button Missing:</h6>
                        <ul class="text-sm text-white/60 space-y-1 ml-4">
                          <li>‚Ä¢ Refresh the webpage</li>
                          <li>‚Ä¢ Try a different website</li>
                          <li>‚Ä¢ Check browser console for errors</li>
                        </ul>
                      </div>
                      <div>
                        <h6 class="font-semibold text-white mb-2">Popup Doesn't Open:</h6>
                        <ul class="text-sm text-white/60 space-y-1 ml-4">
                          <li>‚Ä¢ Right-click extension icon ‚Üí "Inspect popup"</li>
                          <li>‚Ä¢ Check for JavaScript errors in console</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script>
      // Protect route: check session and load user data
      fetch('/api/auth/me').then(r=>r.json()).then(d=>{ 
        if(!d.user){ 
          window.location.href='/auth.html'; 
        } else {
          // Load user email in tooltip
          const userEmailText = document.getElementById('userEmailText');
          if (userEmailText) {
            userEmailText.textContent = d.user.email;
          }
        }
      }).catch(()=> window.location.href='/auth.html');

      // Search functionality
      const searchBtn = document.getElementById('searchBtn');
      const searchInput = document.getElementById('searchInput');
      const refreshBtn = document.getElementById('refreshBtn');
      
      if (searchBtn && searchInput) {
        searchBtn.addEventListener('click', () => {
          const expanded = searchInput.classList.contains('opacity-100');
          if (expanded) { 
            searchInput.classList.remove('opacity-100'); 
            searchInput.style.width='0px'; 
            searchInput.style.paddingLeft='0px'; 
            searchInput.style.paddingRight='0px'; 
            searchInput.classList.add('opacity-0'); 
          } else { 
            searchInput.style.width='220px'; 
            searchInput.style.paddingLeft='12px'; 
            searchInput.style.paddingRight='12px'; 
            searchInput.classList.remove('opacity-0'); 
            searchInput.classList.add('opacity-100'); 
            searchInput.focus(); 
          }
        });
      }

      refreshBtn?.addEventListener('click', ()=>{ 
        // Add loading animation to refresh button
        const refreshIcon = refreshBtn.querySelector('svg');
        if (refreshIcon) {
          refreshIcon.classList.add('animate-spin');
        }
        // Refresh chat or reload page
        setTimeout(() => {
          if (refreshIcon) {
            refreshIcon.classList.remove('animate-spin');
          }
          location.reload();
        }, 1000);
      });

      // Sign out functionality
      const signout = document.getElementById('signoutBtn');
      if (signout) {
        signout.addEventListener('click', async ()=>{ 
          try { 
            await fetch('/api/auth/logout',{method:'POST'}); 
          } catch(e) {} 
          window.location.href='/auth.html'; 
        });
      }

      // Download Extension functionality
      const downloadExtensionBtn = document.getElementById('downloadExtensionBtn');
      const downloadZipBtn = document.getElementById('downloadZipBtn');

      async function downloadExtensionZip(event) {
        // Determine which button was clicked
        let clickedButton;
        
        try {
          clickedButton = event.target.closest('#downloadZipBtn') || event.target.closest('#downloadExtensionBtn') || downloadZipBtn;
          // Show loading state
          if (clickedButton) {
            clickedButton.disabled = true;
            clickedButton.innerHTML = `
              <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              Creating zip...
            `;
          }

          // Call backend API to download extension zip
          const response = await fetch('/api/extension/download-zip', {
            method: 'GET',
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          // Check if response is a zip file or JSON
          const contentType = response.headers.get('content-type');
          
          if (contentType && contentType.includes('application/zip')) {
            // Direct zip download
            const blob = await response.blob();
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = 'PitchLense-Extension.zip';
            
            // Trigger download
            document.body.appendChild(a);
            a.click();
            
            // Cleanup
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
          } else {
            // Fallback: Create zip from file data
            const data = await response.json();
            
            if (!data.files || !Array.isArray(data.files)) {
              throw new Error('Invalid response format');
            }

            // Create zip using JSZip
            if (typeof JSZip === 'undefined') {
              throw new Error('JSZip library not loaded');
            }

            const zip = new JSZip();
            
            // Add files to zip
            data.files.forEach(file => {
              if (file.name && file.content) {
                // Convert base64 to binary
                const binaryString = atob(file.content);
                zip.file(file.name, binaryString);
              }
            });

            // Generate zip
            const zipBlob = await zip.generateAsync({type: 'blob'});
            
            // Create download link
            const url = window.URL.createObjectURL(zipBlob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = data.filename || 'PitchLense-Extension.zip';
            
            // Trigger download
            document.body.appendChild(a);
            a.click();
            
            // Cleanup
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
          }

          // Show success message
          Swal.fire({
            title: 'Success!',
            text: 'Extension zip downloaded successfully',
            icon: 'success',
            timer: 2000,
            showConfirmButton: false
          });

        } catch (error) {
          console.error('Error downloading extension zip:', error);
          Swal.fire({
            title: 'Error!',
            text: 'Failed to download extension zip. Please try again.',
            icon: 'error',
            confirmButtonText: 'OK'
          });
        } finally {
          // Reset button state
          if (clickedButton) {
            clickedButton.disabled = false;
            
            
            if (clickedButton.id === 'downloadZipBtn') {
              clickedButton.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                  <polyline points="14,2 14,8 20,8"/>
                  <line x1="16" y1="13" x2="8" y2="13"/>
                  <line x1="16" y1="17" x2="8" y2="17"/>
                  <polyline points="10,9 9,9 8,9"/>
                </svg>
                Download Extension.zip
              `;
            } else {
              clickedButton.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7,10 12,15 17,10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Download Extension
              `;
            }
          }
        }
      }

      // Event listeners for download buttons
      if (downloadExtensionBtn) {
        downloadExtensionBtn.addEventListener('click', downloadExtensionZip);
      }
      
      if (downloadZipBtn) {
        downloadZipBtn.addEventListener('click', downloadExtensionZip);
      }
    </script>
    
    <!-- Circular Footer with Heart Icon -->
    <footer class="fixed bottom-4 right-4 z-50">
      <!-- Expanded Footer Content (Hidden by default) -->
      <div class="footer-expanded bg-[#2E3137] border border-white/10 rounded-[22px] px-4 py-3 mb-2 opacity-0 transform translate-y-2 pointer-events-none transition-all duration-300 ease-out">
        <div class="flex items-center justify-center gap-2 text-sm text-white/80 whitespace-nowrap overflow-x-auto">
          <span>Created with</span>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" fill="#ef4444"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"/></svg>
          <span>by</span>
          <a href="https://amanulla.in/" target="_blank" rel="noopener noreferrer" class="text-[#60a5fa] hover:text-white transition-colors font-medium">Aman Ulla</a>
          <span>,</span>
          <a href="#" target="_blank" rel="noopener noreferrer" class="text-[#60a5fa] hover:text-white transition-colors font-medium">Srinivas Alva</a>
          <span class="text-white/40">|</span>
          <a href="https://vision.hack2skill.com/event/genaiexchangehackathon/?utm_source=hack2skill&utm_medium=homepage#overview" target="_blank" rel="noopener noreferrer" class="text-[#60a5fa] hover:text-white transition-colors">Hack2Skill‚ÄëGoogle Hackathon</a>
          <span class="text-white/40">|</span>
          <div class="flex items-center gap-2">
            <a href="https://github.com/connectaman/PitchLense" target="_blank" rel="noopener noreferrer" title="GitHub" class="w-8 h-8 grid place-items-center rounded-full bg-[#FFF27A] text-[#1E1E21] hover:opacity-80">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.52 2.87 8.35 6.84 9.71.5.09.68-.22.68-.49 0-.24-.01-.87-.01-1.7-2.78.62-3.37-1.37-3.37-1.37-.46-1.2-1.13-1.52-1.13-1.52-.92-.65.07-.64.07-.64 1.02.07 1.56 1.06 1.56 1.06.9 1.58 2.36 1.12 2.94.86.09-.67.35-1.12.63-1.38-2.22-.26-4.56-1.14-4.56-5.08 0-1.12.39-2.04 1.04-2.76-.1-.26-.45-1.32.1-2.75 0 0 .84-.27 2.76 1.05.8-.23 1.66-.35 2.52-.35s1.72.12 2.52.35c1.92-1.32 2.76-1.05 2.76-1.05.55 1.43.2 2.49.1 2.75.65.72 1.04 1.64 1.04 2.76 0 3.95-2.34 4.82-4.57 5.07.36.31.68.93.68 1.88 0 1.35-.01 2.45-.01 2.78 0 .27.18.58.69.48A10.03 10.03 0 0 0 22 12.26C22 6.58 17.52 2 12 2Z"/></svg>
            </a>
            <a href="https://pypi.org/project/pitchlense-mcp/" target="_blank" rel="noopener noreferrer" title="PyPI" class="w-8 h-8 grid place-items-center rounded-full bg-[#FFF27A] text-[#1E1E21] hover:opacity-80">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 3a4 4 0 0 1 4 4v3a2 2 0 0 1-2 2H8a4 4 0 0 1-4-4V5a2 2 0 0 1 2-2h6Zm-2 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm2 14a4 4 0 0 1-4-4v-3a2 2 0 0 1 2-2h6a4 4 0 0 1 4 4v3a2 2 0 0 1-2 2h-6Zm2-4a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"/></svg>
            </a>
            <a href="https://pitchlense-mcp.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer" title="Read the Docs" class="w-8 h-8 grid place-items-center rounded-full bg-[#FFF27A] text-[#1E1E21] hover:opacity-80">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M5 3h12a2 2 0 0 1 2 2v14l-3-2-3 2-3-2-3 2-3-2V5a2 2 0 0 1 2-2Zm2 4v2h8V7H7Zm0 4v2h8v-2H7Z"/></svg>
            </a>
          </div>
        </div>
      </div>
      
      <!-- Circular Heart Icon Button -->
      <div class="footer-circle w-12 h-12 bg-[#2E3137] border border-white/10 rounded-full flex items-center justify-center cursor-pointer hover:bg-[#3a3d44] transition-all duration-300 ease-out shadow-lg hover:shadow-xl">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="#ef4444" class="transition-transform duration-300 ease-out">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 1 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
      </div>
    </footer>
    
    <!-- Mobile Navigation Menu -->
    <div id="mobileMenu" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden md:hidden">
      <div class="bg-[#2C2F34] border border-white/10 rounded-[18px] m-4 p-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-white">Navigation</h3>
          <button id="closeMobileMenu" class="w-8 h-8 grid place-items-center rounded-full bg-[#FFF27A] text-[#1E1E21]">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        <nav class="flex flex-col gap-2 text-white/80">
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/create-report.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            <span>Create Report</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/view-report.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <line x1="9" y1="17" x2="9" y2="11"/>
              <line x1="13" y1="17" x2="13" y2="7"/>
              <line x1="17" y1="17" x2="17" y2="13"/>
            </svg>
            <span>Reports</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/market.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 3v18h18"/>
              <path d="M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"/>
            </svg>
            <span>Market Data</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/investment.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="1" x2="12" y2="23"></line>
              <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
            <span>Investments</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/search.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <span>Search Symbols</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/news.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 3h16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/>
              <line x1="7" y1="8" x2="17" y2="8"/>
              <line x1="7" y1="12" x2="17" y2="12"/>
              <line x1="7" y1="16" x2="13" y2="16"/>
            </svg>
            <span>Market News</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-white/10" href="/extension.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="7" height="7"/>
              <rect x="14" y="3" width="7" height="7"/>
              <rect x="14" y="14" width="7" height="7"/>
              <rect x="3" y="14" width="7" height="7"/>
            </svg>
            <span>Extension</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="/email.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
            <span>Email Client</span>
          </a>
          <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10" href="https://youtu.be/XUuLeXaEIdI" target="_blank">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
            <span>How to use PitchLense</span>
          </a>
          <div class="border-t border-white/10 my-2"></div>
          <button id="mobileSignoutBtn" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/10 text-white/80">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            <span>Sign out</span>
          </button>
        </nav>
      </div>
    </div>

    <!-- Mobile Menu JavaScript -->
    <script>
      // Mobile menu functionality
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const closeMobileMenu = document.getElementById('closeMobileMenu');
      const mobileSignoutBtn = document.getElementById('mobileSignoutBtn');

      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', () => {
          mobileMenu.classList.remove('hidden');
        });
      }

      if (closeMobileMenu && mobileMenu) {
        closeMobileMenu.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      }

      if (mobileSignoutBtn) {
        mobileSignoutBtn.addEventListener('click', async () => {
          try { await fetch('/api/auth/logout',{method:'POST'}); } catch(e) {}
          window.location.href='/auth.html';
        });
      }

      // Close mobile menu when clicking outside
      if (mobileMenu) {
        mobileMenu.addEventListener('click', (e) => {
          if (e.target === mobileMenu) {
            mobileMenu.classList.add('hidden');
          }
        });
      }
    </script>
    
    <script src="/static/navbar.js"></script>
  </body>
</html>

